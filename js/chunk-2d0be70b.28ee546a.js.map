{"version":3,"sources":["webpack:///./src/views/Auth.vue","webpack:///./src/use/login-form.js","webpack:///./src/views/Auth.vue?80ab"],"names":["_createElementVNode","for","class","_createElementBlock","onSubmit","_ctx","_hoisted_1","_hoisted_2","id","type","onBlur","_hoisted_4","autocomplete","_createVNode","_component_VButton","disabled","_hoisted_6","useLoginForm","store","useStore","router","useRouter","PASSWORD_LENGTG","handleSubmit","isSubmitting","submitCount","useForm","value","email","errorMessage","emailError","handleBlur","emailBlur","useField","yup","trim","required","password","passwordError","passwordBlur","min","manyAttempt","computed","watch","setTimeout","async","dispatch","values","push","e","name","setup","route","useRoute","query","message","error","__exports__","render"],"mappings":"iJAKIA,eAAwB,UAApB,mBAAe,G,EAGjBA,eAAgC,SAAzBC,IAAI,SAAQ,SAAK,G,YAWxBD,eAAoC,SAA7BC,IAAI,YAAW,UAAM,G,mBAmBxBC,MAAM,e,kFArCdC,eA0CO,QAzCFC,SAAM,mCAAUC,6BAAQ,cACzBH,MAAM,Q,CAERI,EAEAN,eASM,OATAE,MAAK,wCAA+BG,iB,CACxCE,EAAgC,eAChCP,eAIE,SAJKQ,GAAG,QACHC,KAAK,Q,qCACIJ,QAAK,GACbK,OAAI,oBAAEL,iC,mBADEA,WAIHA,cAAU,iBAAvBF,eAAiD,yBAArBE,cAAU,8BAGxCL,eAUM,OAVAE,MAAK,wCAA+BG,oB,CACxCM,EAAoC,eACpCX,eAKE,SALKQ,GAAG,WACHC,KAAK,WACLG,aAAa,K,qCACJP,WAAQ,GAChBK,OAAI,oBAAEL,uC,mBADEA,cAIHA,iBAAa,iBAA1BF,eAAuD,yBAAxBE,iBAAa,8BAG9CQ,eAKUC,GAJNL,KAAK,SACJM,SAAUV,gBAAgBA,e,wBAC9B,IAED,gBAFC,a,qBAIQA,eAAW,iBAApBF,eAKI,IALJa,EAEC,mDAGD,2B,8DCpCG,SAASC,IACZ,MAAMC,EAAQC,iBACRC,EAASC,iBACTC,EAAkB,GAClB,aAACC,EAAY,aAAEC,EAAY,YAAEC,GAAeC,kBAE3CC,MAAOC,EAAOC,aAAcC,EAAYC,WAAYC,GAAaC,eACpE,QACAC,SAEKC,OACAC,SAAS,8BACTR,MAAM,0BAERD,MAAOU,EAAUR,aAAcS,EAAeP,WAAYQ,GAAgBN,eAC7E,WACAC,SAEKC,OACAC,SAAS,+BACTI,IAAIlB,EAAkB,qCAAoCA,eAG7DmB,EAAcC,eAAS,IAAMjB,EAAYE,OAAS,GAExDgB,eAAMF,EAAad,IACXA,GACAiB,WAAW,KACPnB,EAAYE,MAAQ,GACrB,OAIX,MAAMvB,EAAWmB,EAAasB,UAC1B,UACU3B,EAAM4B,SAAS,aAAcC,GACnC3B,EAAO4B,KAAK,KACd,MAAOC,OAMb,MAAO,CACHrB,QACAE,aACAE,YACAK,WACAC,gBACAC,eACAnC,WACAoB,eACAiB,e,gBDNO,GACbS,KAAM,OAENC,QACE,MAAMC,EAAQC,iBACRnC,EAAQC,iBASd,OAPGiC,EAAME,MAAMC,SACbrC,EAAM4B,SAAS,aAAc,CAC3BnB,MAAO6B,eAAMJ,EAAME,MAAMC,SACzB9C,KAAM,YAIH,IAAIQ,O,qBE7Df,MAAMwC,EAA2B,IAAgB,EAAQ,CAAC,CAAC,SAASC,KAErD","file":"js/chunk-2d0be70b.28ee546a.js","sourcesContent":["<template>\n  <form\n      @submit.prevent=\"onSubmit\"\n      class=\"card\"\n  >\n    <h1>Войти в систему</h1>\n\n    <div :class=\"['form-control', {'invalid': emailError}]\">\n      <label for=\"email\">Email</label>\n      <input id=\"email\"\n             type=\"email\"\n             v-model=\"email\"\n             @blur=\"emailBlur\"\n      />\n\n      <small v-if=\"emailError\">{{ emailError }}</small>\n    </div>\n\n    <div :class=\"['form-control', {'invalid': passwordError}]\">\n      <label for=\"password\">Пароль</label>\n      <input id=\"password\"\n             type=\"password\"\n             autocomplete=\"on\"\n             v-model=\"password\"\n             @blur=\"passwordBlur\"\n      />\n\n      <small v-if=\"passwordError\">{{ passwordError }}</small>\n    </div>\n\n    <VButton\n        type=\"submit\"\n        :disabled=\"isSubmitting || manyAttempt\"\n    >\n      Войти\n    </VButton>\n\n    <p v-if=\"manyAttempt\"\n          class=\"text-danger\"\n    >\n      Слишком много попыток входа\n      Попробуйте позже\n    </p>\n  </form>\n</template>\n\n<script>\nimport {useLoginForm} from '../use/login-form';\nimport {useRoute} from 'vue-router';\nimport {useStore} from \"vuex\";\nimport {error} from \"../utils/error\";\n\nexport default {\n  name: 'Auth',\n\n  setup() {\n    const route = useRoute();\n    const store = useStore();\n\n    if(route.query.message) {\n      store.dispatch('setMessage', {\n        value: error(route.query.message),\n        type: 'warning',\n      })\n    }\n\n    return {...useLoginForm()}\n  }\n}\n</script>\n","import {useField, useForm} from \"vee-validate\";\nimport * as yup from \"yup\";\nimport {computed, watch} from \"vue\";\nimport { useStore } from 'vuex';\nimport { useRouter } from 'vue-router';\n\nexport function useLoginForm() {\n    const store = useStore();\n    const router = useRouter();\n    const PASSWORD_LENGTG = 6;\n    const {handleSubmit, isSubmitting, submitCount} = useForm();\n\n    const {value: email, errorMessage: emailError, handleBlur: emailBlur} = useField(\n        'email',\n        yup\n            .string()\n            .trim()\n            .required('Email не может быть пустым')\n            .email('Email введен неверно')\n    );\n    const {value: password, errorMessage: passwordError, handleBlur: passwordBlur} = useField(\n        'password',\n        yup\n            .string()\n            .trim()\n            .required('Пароль не может быть пустым')\n            .min(PASSWORD_LENGTG, `Длина пароля не может быть короче ${PASSWORD_LENGTG} символов`)\n    );\n\n    const manyAttempt = computed(() => submitCount.value >= 3)\n\n    watch(manyAttempt, value => {\n        if (value) {\n            setTimeout(() => {\n                submitCount.value = 0;\n            }, 5000)\n        }\n    })\n\n    const onSubmit = handleSubmit(async values => {\n        try {\n            await store.dispatch('auth/login', values);\n            router.push('/');\n        } catch (e) {\n            //\n        }\n\n    });\n\n    return {\n        email,\n        emailError,\n        emailBlur,\n        password,\n        passwordError,\n        passwordBlur,\n        onSubmit,\n        isSubmitting,\n        manyAttempt,\n    }\n}\n","import { render } from \"./Auth.vue?vue&type=template&id=430c96c3\"\nimport script from \"./Auth.vue?vue&type=script&lang=js\"\nexport * from \"./Auth.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"/Users/user/WebstormProjects/vue-srm/node_modules/vue-loader-v16/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"sourceRoot":""}